<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=windows-1252" http-equiv="content-type">
    <link rel="shortcut icon" href="http://web.mit.edu/rsridhar/www/favicon.png" />
    <link rel="stylesheet" type="text/css" href="codes.css">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open Sans">
    <script src="../jquery.js"></script>
    <script type='application/javascript' src='fastclick.js'></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $(function() {
          FastClick.attach(document.body);
        });

        var first = 0;
        var second = 0;
        var flag_map = [
                        ['',  '',  '',  '',  '',  '',  '',  '',  ''],
                        ['',  '', '#', 'J', 'V', 'D', 'K', 'P', 'T'],
                        ['', '#',  '', 'W', 'X', 'E', 'L', 'Q', 'U'],
                        ['', 'J', 'W',  '', 'Z', 'F', 'M', 'R', 'Y'],
                        ['', 'V', 'X', 'Z',  '', 'G', 'N', 'S', '?'],
                        ['', 'D', 'E', 'F', 'G', ' ', 'A', 'B', 'C'],
                        ['', 'K', 'L', 'M', 'N', 'A',  '', 'H', 'I'],
                        ['', 'P', 'Q', 'R', 'S', 'B', 'H',  '', 'O'],
                        ['', 'T', 'U', 'Y', '?', 'C', 'I', 'O',  ''],
                       ]

        // positioning
        $('#c1').css('left', '130px'); $('#c1').css('top',   '0px');
        $('#c2').css('left', '187px'); $('#c2').css('top',  '23px');
        $('#c3').css('left', '210px'); $('#c3').css('top',  '80px');
        $('#c4').css('left', '187px'); $('#c4').css('top', '137px');
        $('#c5').css('left', '130px'); $('#c5').css('top', '160px');
        $('#c6').css('left',  '73px'); $('#c6').css('top', '137px');
        $('#c7').css('left',  '50px'); $('#c7').css('top',  '80px');
        $('#c8').css('left',  '73px'); $('#c8').css('top',  '23px');

        // rotation
        $('#c2').css('transform', 'rotate(45deg)');
        $('#c4').css('transform', 'rotate(45deg)');
        $('#c6').css('transform', 'rotate(45deg)');
        $('#c8').css('transform', 'rotate(45deg)');

        function translate() {
          $("#outputbox").html('<p class="key">' + flag_map[first][second] + '</p>');
        }

        function toggle_cell(hid) {
          id = hid.slice(-1);
          if ($(hid).css("background-color") == "rgb(0, 0, 0)") {
            $(hid).css("background-color", "#CFCFCF");
            if (second == 0) {
              first = 0;
            }
            else {
              if (id == first) {
                first = second;
                second = 0;
              }
              else {
                second = 0;
              }
            }
          }
          else {
            $(hid).css("background-color", "#000000");
            if (first == 0) {
              first = id;
            }
            else if (second == 0) {
              second = id;
            }
            else {
              hfirst = '#c' + first;
              $(hfirst).css("background-color", "#CFCFCF");
              first = second;
              second = id;
            }
          }
          translate();
        }

        $('.flag').click( function toggle(event) {
          toggle_cell('#' + event.target.id);
          console.log("first = " + first);
          console.log("second = " + second);
        });
        $("#outputbox").click( function record() {
          $("#ciphertext").html($("#ciphertext").html() + flag_map[first][second]);
        });
      });
    </script>

    <title>Semaphore</title>
  </head>
  <body>
    <h1>Semaphore</h1>
    <div id="toolbox">
      <p>Input: </p>
      <div id="wrapper">
        <div id="inputbox">
          <div id="c1" class="flag"></div>
          <div id="c2" class="flag"></div>
          <div id="c3" class="flag"></div>
          <div id="c4" class="flag"></div>
          <div id="c5" class="flag"></div>
          <div id="c6" class="flag"></div>
          <div id="c7" class="flag"></div>
          <div id="c8" class="flag"></div>
        </div>
        <div id="wrapper2">
          <div id="outputbox">
          </div>
        </div>
      </div>
      <span id="output">Output:</span>
      <div id="ciphertext">
      </div>
    </div>
  </body>
</html>
